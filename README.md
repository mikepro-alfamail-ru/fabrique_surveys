# Тестовое задание для fabrique.studio

## Задача:

 спроектировать и разработать API для системы опросов пользователей.

Функционал для администратора системы:

- авторизация в системе (регистрация не нужна)
- добавление/изменение/удаление опросов. Атрибуты опроса: название, дата старта, дата окончания, описание. После создания поле "дата старта" у опроса менять нельзя
- добавление/изменение/удаление вопросов в опросе. Атрибуты вопросов: текст вопроса, тип вопроса (ответ текстом, ответ с выбором одного варианта, ответ с выбором нескольких вариантов)

Функционал для пользователей системы:

- получение списка активных опросов
- прохождение опроса: опросы можно проходить анонимно, в качестве идентификатора пользователя в API передаётся числовой ID, по которому сохраняются ответы пользователя на вопросы; один пользователь может участвовать в любом количестве опросов
- получение пройденных пользователем опросов с детализацией по ответам (что выбрано) по ID уникальному пользователя

Использовать следующие технологии: Django 2.2.10, Django REST framework.

## Решение:

### Установка

```
git clone https://github.com/mikepro-alfamail-ru/fabrique_surveys.git

pip -r requirements.txt
```

Настроить DATABASES в settings.py под ваш вариант БД

```
manage.py migrate

manage.py loaddata questiontypes.json

manage.py createsuperuser

manage.py runserver
```

### Описание API

#### /api/surveys

*GET* получить информацию об опросах. Пример ответа ниже:

```
[
    {
        "id": 20,
        "title": "Название опроса",
        "start_at": "2003-03-03",
        "finish_at": "2021-07-07",
        "description": "Описание опроса",
        "question": [
            {
                "question": "Наименование вопроса",
                "type": 1,
                "answervariant": [
                    {
                        "title": "Вариант ответа"
                    }
                ]
            },
            {
                "question": "Наименование вопроса",
                "type": 1,
                "answervariant": []
            }
        ]
    }
]
```

*POST* - создать новый опрос. Авторизация через BasicAuth, пользователь - суперюзер в джанго

*PATCH* /api/surveys/<_ id _> - Обновить опрос. Работает только с полями title, finish_at, description

Авторизация аналогично *POST*

#### /api/questions

Методы и авторизация аналогичны **surveys** 

#### /api/answervariants

Методы и авторизация аналогичны **surveys**

#### /api/useranswers

Передать в теле запроса параметр "user" для получения ответов пользователя

Пример ответа:
```
[
    {
        "id": 1,
        "user": 8888,
        "answer": "jhasdjdsh",
        "question": 5
    },
    {
        "id": 2,
        "user": 8888,
        "answer": "asdasda",
        "question": 4
    }
]
```


*POST* - записать ответ пользователя